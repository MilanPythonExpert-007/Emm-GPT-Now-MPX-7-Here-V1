<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MPX 7 Assistant</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap');

        /* Define CSS Variables for colors and spacing */
        :root {
            --primary: #5a67d8;
            --primary-dark: #4c51bf;
            --primary-light: #a3bffa;
            --secondary: #f7fafc;
            --text: #2d3748;
            --text-light: #4a5568;
            --text-lighter: #718096;
            --border: #e2e8f0;
            --border-light: #edf2f7;
            --white: #ffffff;
            --bg: #f8fafc;
            --user-bubble: var(--primary);
            --bot-bubble: #edf2f7;
            --error: #f56565;
            --success: #48bb78;
            --shadow-sm: 0 1px 2px 0 rgba(0, 0, 0, 0.05);
            --shadow: 0 1px 3px 0 rgba(0, 0, 0, 0.1), 0 1px 2px 0 rgba(0, 0, 0, 0.06);
            --shadow-md: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
            --radius-sm: 4px;
            --radius: 8px;
            --radius-lg: 12px;
            --radius-xl: 16px;
            --radius-full: 9999px;
            --transition: all 0.2s cubic-bezier(0.4, 0, 0.2, 1);
            --gradient-start: #667eea;
            --gradient-end: #764ba2;
        }


        /* Dark mode variables */
        .dark-mode {
            --primary: #667eea;
            --primary-dark: #5a67d8;
            --secondary: #2d3748;
            --text: #f7fafc;
            --text-light: #e2e8f0;
            --text-lighter: #a0aec0;
            --border: #4a5568;
            --border-light: #2d3748;
            --white: #1a202c;
            --bg: #1a202c;
            --bot-bubble: #2d3748;
            --shadow-sm: 0 1px 2px 0 rgba(0, 0, 0, 0.25);
            --shadow: 0 1px 3px 0 rgba(0, 0, 0, 0.3), 0 1px 2px 0 rgba(0, 0, 0, 0.2);
            --shadow-md: 0 4px 6px -1px rgba(0, 0, 0, 0.3), 0 2px 4px -1px rgba(0, 0, 0, 0.2);
            --gradient-start: #764ba2;
            --gradient-end: #667eea;
        }

        /* Basic reset and box-sizing */
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }

        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
            background: linear-gradient(135deg, var(--gradient-start), var(--gradient-end));
            color: var(--text);
            line-height: 1.5;
            height: 100vh;
            display: flex;
            flex-direction: column;
            overflow: hidden;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
            transition: all 0.3s ease;
        }


        /* Chat container */
        .chat-app {
            display: flex;
            flex-direction: column;
            height: 100vh;
            width: 100%;
            margin: 0 auto;
            background-color: var(--white);
            position: relative;
            overflow: hidden;
            max-width: 800px;
            border-radius: var(--radius-lg);
            box-shadow: var(--shadow-md);
            transition: background-color 0.3s ease;
        }


        /* Header */
        .chat-header {
            padding: 16px 20px;
            display: flex;
            align-items: center;
            background: linear-gradient(90deg, var(--gradient-start), var(--gradient-end));
            color: white;
            z-index: 10;
            position: relative;
            transition: all 0.3s ease;
            box-shadow: var(--shadow-md);
        }


        .logo {
            width: 36px;
            height: 36px;
            background-color: rgba(255, 255, 255, 0.2);
            border-radius: var(--radius);
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--white);
            font-weight: bold;
            margin-right: 12px;
            font-size: 16px;
            flex-shrink: 0;
            transition: var(--transition);
            backdrop-filter: blur(5px);
        }


        .chat-title {
            font-weight: 700;
            font-size: 18px;
            color: white;
            transition: color 0.3s ease;
            letter-spacing: 0.5px;
            text-shadow: 0 1px 2px rgba(0,0,0,0.2);

        }

        .header-actions {
            margin-left: auto;
            display: flex;
            gap: 8px;
        }


        .header-btn {
            background: rgba(255, 255, 255, 0.15);
            border: none;
            color: white;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            width: 36px;
            height: 36px;
            border-radius: var(--radius);
            transition: var(--transition);
            backdrop-filter: blur(5px);

        }

        .header-btn:hover {
            background: rgba(255, 255, 255, 0.3);
            transform: translateY(-2px);

        }


        .header-btn svg {
            width: 20px;
            height: 20px;
        }


        /* Messages area */
        .chat-messages {
            flex: 1;
            overflow-y: auto;
            padding: 20px;
            display: flex;
            flex-direction: column;
            scroll-behavior: smooth;
            background-color: var(--bg);
            transition: background-color 0.3s ease;
            position: relative;

        }

        .message {
            margin-bottom: 20px;
            max-width: 90%;
            display: flex;
            flex-direction: column;
            animation: fadeIn 0.3s ease-out;

        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }

        }

        .bot-message {
            align-self: flex-start;
        }

        .user-message {
            align-self: flex-end;

        }

        .message-bubble {
            padding: 14px 18px;
            border-radius: var(--radius-xl);
            line-height: 1.6;
            font-size: 15px;
            word-wrap: break-word;
            white-space: pre-wrap;
            transition: var(--transition);
            position: relative;
            overflow: hidden;
            box-shadow: var(--shadow-sm);

        }

        .bot-bubble {
            background-color: var(--bot-bubble);
            border-top-left-radius: var(--radius-sm);
            color: var(--text);
            border: 1px solid var(--border-light);

        }

        .user-bubble {
            background: linear-gradient(90deg, var(--primary), var(--primary-dark));
            color: var(--white);
            border-top-right-radius: var(--radius-sm);
        }


        .message-meta {
            display: flex;
            align-items: center;
            margin-top: 8px;
            font-size: 12px;
            color: var(--text-lighter);

        }

        .bot-meta {
            justify-content: flex-start;
            margin-left: 10px;

        }

        .user-meta {
            justify-content: flex-end;
            margin-right: 10px;

        }

        .message-time {
            margin-left: 8px;
            font-feature-settings: "tnum";
        }


        /* Message content formatting */
        .message-code {
            background-color: rgba(0, 0, 0, 0.05);
            padding: 12px;
            border-radius: var(--radius);
            font-family: 'Menlo', 'Monaco', 'Courier New', monospace;
            margin: 8px 0;
            overflow-x: auto;
            font-size: 14px;

            line-height: 1.4;
        }

        .message-link {
            color: var(--primary);
            text-decoration: none;
            border-bottom: 1px solid rgba(90, 103, 216, 0.3);
            transition: var(--transition);
        }


        .message-link:hover {
            color: var(--primary-dark);
            border-bottom-color: var(--primary);
        }


        code {
            background-color: rgba(0, 0, 0, 0.05);
            padding: 2px 4px;
            border-radius: var(--radius-sm);
            font-family: 'Menlo', 'Monaco', 'Courier New', monospace;
            font-size: 0.9em;
        }


        /* Typing indicator */
        .typing-indicator {
            display: flex;
            align-items: center;
            margin-left: 10px;
            color: var(--text-lighter);
            font-size: 13px;

        }

        .dots {
            display: inline-flex;
            margin-left: 6px;

        }

        .dot {
            width: 6px;
            height: 6px;
            border-radius: 50%;
            background-color: var(--text-lighter);
            margin-right: 4px;
            animation: bounce 1.4s infinite ease-in-out;
        }


        .dot:nth-child(2) {
            animation-delay: 0.2s;
        }


        .dot:nth-child(3) {
            animation-delay: 0.4s;
        }

        @keyframes bounce {

            0%, 80%, 100% { transform: translateY(0); }
            40% { transform: translateY(-5px); }
        }

        /* Typewriter effect */
        .typewriter {
            display: inline-block;
            overflow: hidden;
            border-right: 2px solid var(--primary);
            white-space: pre-wrap;
            margin: 0;
            letter-spacing: normal;
            animation: blink-caret 0.75s step-end infinite;
        }


        @keyframes blink-caret {
            from, to { border-color: transparent }
            50% { border-color: var(--primary); }

        }

        /* Input area */
        .input-container {
            padding: 16px 20px;
            border-top: 1px solid var(--border-light);
            background-color: var(--white);
            position: relative;
            transition: all 0.3s ease;
            box-shadow: var(--shadow);

        }

        .input-area {
            display: flex;
            align-items: flex-end;
            border: 1px solid var(--border);
            border-radius: var(--radius-xl);
            overflow: hidden;
            background-color: var(--white);
            transition: var(--transition);
            box-shadow: var(--shadow-sm);

        }

        .input-area:focus-within {
            border-color: var(--primary);
            box-shadow: 0 0 0 2px rgba(90, 103, 216, 0.2);

        }

        .input-field {
            flex: 1;
            border: none;
            padding: 14px 16px;
            font-size: 15px;
            outline: none;
            background-color: transparent;
            color: var(--text);
            min-height: 50px;
            max-height: 150px;
            resize: none;
            line-height: 1.5;
            font-family: inherit;
            transition: all 0.3s ease;

        }

        .input-field::placeholder {
            color: var(--text-lighter);

        }

        .input-actions {
            display: flex;
            align-items: flex-end;
            padding: 0 8px 8px 0;
        }


        .input-btn {
            background: none;
            border: none;
            padding: 6px;
            cursor: pointer;
            color: var(--text-light);
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: var(--radius);
            transition: var(--transition);

        }

        .input-btn:hover {
            background-color: var(--secondary);
            color: var(--primary);

        }

        .input-btn svg {
            width: 20px;
            height: 20px;

        }

        .send-button {
            background: linear-gradient(90deg, var(--primary), var(--primary-dark));
            color: white;
            border-radius: var(--radius);
            width: 36px;
            height: 36px;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.2s ease;

        }

        .send-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(90, 103, 216, 0.3);
        }


        .send-button:disabled {
            background: var(--border);
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }


        /* Suggestions */
        .suggestions {
            padding: 0 20px 16px;
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
            transition: all 0.3s ease;

        }

        .suggestion {
            background: linear-gradient(90deg, rgba(90, 103, 216, 0.1), rgba(76, 81, 191, 0.1));
            border-radius: var(--radius-xl);
            padding: 8px 16px;
            font-size: 13px;
            cursor: pointer;
            transition: var(--transition);
            color: var(--primary);
            border: none;
            outline: none;
            font-family: inherit;
            backdrop-filter: blur(5px);

            border: 1px solid rgba(90, 103, 216, 0.2);
        }

        .suggestion:hover {
            background: linear-gradient(90deg, rgba(90, 103, 216, 0.2), rgba(76, 81, 191, 0.2));
            color: var(--primary-dark);

            transform: translateY(-2px);
        }

        /* Image preview */
        .image-preview {
            max-width: 100%;
            max-height: 200px;
            border-radius: var(--radius);
            margin-top: 8px;
            box-shadow: var(--shadow-sm);
            display: none;
            transition: all 0.3s ease;
            border: 1px solid var(--border);

        }

        /* Settings dropdown */
        .settings-dropdown {
            position: absolute;
            top: 60px;
            right: 20px;
            background-color: var(--white);
            border-radius: var(--radius);
            box-shadow: var(--shadow-md);
            padding: 8px 0;
            z-index: 20;
            width: 200px;
            opacity: 0;
            pointer-events: none;
            transform: translateY(-10px);
            transition: var(--transition);
            backdrop-filter: blur(10px);
            background: rgba(255, 255, 255, 0.9);

            border: 1px solid var(--border);
        }

        .dark-mode .settings-dropdown {
            background: rgba(26, 32, 44, 0.9);
            border: 1px solid var(--border);

        }

        .settings-dropdown.active {
            opacity: 1;

            pointer-events: all;
            transform: translateY(0);
        }

        .settings-item {
            padding: 12px 16px;
            display: flex;
            align-items: center;
            cursor: pointer;
            transition: var(--transition);
            color: var(--text);

            font-size: 14px;
        }

        .settings-item:hover {
            background-color: var(--secondary);
        }


        .settings-item svg {
            margin-right: 10px;
            width: 16px;
            height: 16px;
            color: var(--text-light);
        }


        /* Loading overlay */
        .loading-overlay {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: rgba(255, 255, 255, 0.8);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 100;
            opacity: 0;
            pointer-events: none;
            transition: opacity 0.3s;

            backdrop-filter: blur(5px);
        }

        .dark-mode .loading-overlay {
            background-color: rgba(26, 32, 44, 0.8);

        }

        .loading-overlay.active {
            opacity: 1;
            pointer-events: all;
        }

        .spinner {
            width: 40px;
            height: 40px;
            border: 4px solid rgba(90, 103, 216, 0.2);
            border-top-color: var(--primary);
            border-radius: 50%;
            animation: spin 1s linear infinite;

        }

        @keyframes spin {

            to { transform: rotate(360deg); }
        }

        /* OCR progress */
        .ocr-progress {
            position: fixed;
            bottom: 100px;
            left: 50%;
            transform: translateX(-50%);
            background-color: var(--white);
            padding: 14px 24px;
            border-radius: var(--radius);
            box-shadow: var(--shadow-md);
            display: flex;
            align-items: center;
            gap: 16px;
            z-index: 1000;
            opacity: 0;
            pointer-events: none;
            transition: opacity 0.3s;
            backdrop-filter: blur(10px);
            background: rgba(255, 255, 255, 0.9);

            border: 1px solid var(--border);
        }

        .dark-mode .ocr-progress {
            background: rgba(26, 32, 44, 0.9);

        }

        .ocr-progress.active {
            opacity: 1;
        }

        .ocr-progress-bar {
            height: 8px;
            background-color: var(--border-light);
            border-radius: 4px;
            overflow: hidden;
            flex: 1;

            min-width: 200px;
        }

        .ocr-progress-fill {
            height: 100%;
            background: linear-gradient(90deg, var(--primary), var(--primary-dark));
            width: 0%;
            transition: width 0.3s;
            border-radius: 4px;

        }

        /* Scrollbar */
        ::-webkit-scrollbar {
            width: 8px;
        }

        ::-webkit-scrollbar-track {

            background: transparent;
        }

        ::-webkit-scrollbar-thumb {

            background: var(--border);
            border-radius: 4px;
        }

        ::-webkit-scrollbar-thumb:hover {
            background: var(--text-lighter);
        }

        /* Scroll to bottom button */
        .scroll-to-bottom {
            position: fixed;
            bottom: 90px;
            right: 30px;
            background: var(--primary);
            color: white;
            width: 36px;
            height: 36px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;

            box-shadow: var(--shadow-md);
            opacity: 0;
            transform: translateY(10px);
            transition: all 0.3s ease;
            z-index: 50;
        }


        .scroll-to-bottom.visible {
            opacity: 1;
            transform: translateY(0);
        }

        /* Responsive adjustments */
        @media (max-width: 600px) {
            .chat-header {
                padding: 14px 16px;

            }
            
            .chat-messages {
                padding: 16px;
            }
            
            .message {
                max-width: 95%;
                margin-bottom: 16px;

            }
            
            .message-bubble {
                padding: 12px 16px;
                font-size: 14px;

            }
            
            .input-container {
                padding: 14px 16px;
            }

            
            .input-field {
                padding: 12px 14px;
                font-size: 14px;
            }
            
            .suggestions {
                padding: 0 16px 14px;

            }

            .settings-dropdown {
                width: 180px;
                right: 16px;

            }
            
            .scroll-to-bottom {
                right: 20px;
                bottom: 80px;

            }
        }

        /* Dark mode toggle */
        .dark-mode-toggle {
            display: flex;
            align-items: center;
            justify-content: space-between;
            width: 100%;
        }

        .toggle-switch {

            position: relative;
            display: inline-block;
            width: 36px;
            height: 20px;
        }

        .toggle-switch input {
            opacity: 0;
            width: 0;
            height: 0;
        }


        .toggle-slider {
            position: absolute;
            cursor: pointer;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: #ccc;
            transition: .4s;
            border-radius: 34px;

        }

        .toggle-slider:before {
            position: absolute;
            content: "";
            height: 16px;
            width: 16px;
            left: 2px;
            bottom: 2px;
            background-color: white;
            transition: .4s;
            border-radius: 50%;

        }

        input:checked + .toggle-slider {
            background-color: var(--primary);

        }

        input:checked + .toggle-slider:before {
            transform: translateX(16px);
        }
        
        /* Welcome message */

        .welcome-message {
            text-align: center;
            padding: 30px 20px;
            max-width: 600px;
            margin: 0 auto;
        }
        
        .welcome-title {
            font-size: 28px;
            font-weight: 700;
            margin-bottom: 16px;
            background: linear-gradient(90deg, var(--gradient-start), var(--gradient-end));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;

            background-clip: text;
        }
        
        .welcome-subtitle {
            font-size: 18px;
            color: var(--text-light);
            margin-bottom: 30px;
            line-height: 1.6;
        }

        
        .features {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-top: 30px;
        }

        
        .feature {
            background: rgba(90, 103, 216, 0.1);
            border-radius: var(--radius);
            padding: 20px;
            text-align: center;
            transition: all 0.3s ease;

        }
        
        .feature:hover {
            transform: translateY(-5px);
            box-shadow: var(--shadow);

        }
        
        .feature-icon {
            font-size: 32px;
            margin-bottom: 15px;
            color: var(--primary);
        }

        
        .feature-title {
            font-weight: 600;
            margin-bottom: 10px;
            color: var(--text);
        }
        

        .feature-desc {
            font-size: 14px;
            color: var(--text-light);
        }
    </style>

</head>
<body>
    <div class="chat-app">
        <!-- Header -->
        <div class="chat-header">
            <div class="logo">M7</div>
            <div class="chat-title">MPX 7 Assistant</div>
            <div class="header-actions">
                <button class="header-btn" id="settings-btn" title="Settings">
                    <svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path d="M12 15C13.6569 15 15 13.6569 15 12C15 10.3431 13.6569 9 12 9C10.3431 9 9 10.3431 9 12C9 13.6569 10.3431 15 12 15Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                        <path d="M19.4 15C19.2669 15.3016 19.227 15.6362 19.285 15.9606C19.343 16.285 19.4965 16.5843 19.725 16.8187C19.9553 17.0536 20.2503 17.2134 20.57 17.2769C20.8897 17.3404 21.2185 17.3048 21.515 17.1747C21.8115 17.0446 22.0618 16.8259 22.233 16.5487C22.4043 16.2715 22.4883 15.9489 22.475 15.6237C22.4617 15.2985 22.3516 14.9858 22.16 14.7277C21.9684 14.4696 21.7047 14.2786 21.405 14.1817" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                        <path d="M2.525 15.6237C2.51172 15.9489 2.59573 16.2715 2.76698 16.5487C2.93824 16.8259 3.18849 17.0446 3.485 17.1747C3.78151 17.3048 4.11031 17.3404 4.43 17.2769C4.74969 17.2134 5.04466 17.0536 5.275 16.8187C5.50354 16.5843 5.65702 16.285 5.715 15.9606C5.77298 15.6362 5.73314 15.3016 5.6 15" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                        <path d="M5.6 9C5.73314 8.69842 5.77298 8.36379 5.715 8.0394C5.65702 7.71501 5.50354 7.41573 5.275 7.18134C5.04466 6.94643 4.74969 6.78659 4.43 6.7231C4.11031 6.65961 3.78151 6.69518 3.485 6.8253C3.18849 6.95542 2.93824 7.17415 2.76698 7.45134C2.59573 7.72853 2.51172 8.05112 2.525 8.37634C2.53828 8.70155 2.64844 9.01423 2.84 9.27232C3.03156 9.53041 3.2953 9.72143 3.595 9.81829" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                        <path d="M19.4 9C19.2669 8.69842 19.227 8.36379 19.285 8.0394C19.343 7.71501 19.4965 7.41573 19.725 7.18134C19.9553 6.94643 20.2503 6.78659 20.57 6.7231C20.8897 6.65961 21.2185 6.69518 21.515 6.8253C21.8115 6.95542 22.0618 7.17415 22.233 7.45134C22.4043 7.72853 22.4883 8.05112 22.475 8.37634C22.4617 8.70155 22.3516 9.01423 22.16 9.27232C21.9684 9.53041 21.7047 9.72143 21.405 9.81829" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                        <path d="M8.81836 5.275C8.58346 5.04466 8.42362 4.74969 8.36013 4.43C8.29664 4.11031 8.33221 3.78151 8.46233 3.485C8.59245 3.18849 8.81118 2.93824 9.08837 2.76698C9.36556 2.59573 9.68815 2.51172 10.0134 2.525C10.3386 2.53828 10.6513 2.64844 10.9094 2.84C11.1674 3.03156 11.3585 3.2953 11.4553 3.595" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                        <path d="M15.1817 21.405C15.4166 21.6353 15.5764 21.9303 15.6399 22.25C15.7034 22.5697 15.6678 22.8985 15.5377 23.195C15.4076 23.4915 15.1888 23.7418 14.9116 23.913C14.6344 24.0843 14.3119 24.1683 13.9866 24.155C13.6614 24.1417 13.3487 24.0316 13.0906 23.84C12.8326 23.6484 12.6415 23.3847 12.5447 23.085" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                        <path d="M12.5447 0.915C12.6415 0.615301 12.8326 0.351563 13.0906 0.16C13.3487 -0.0315634 13.6614 -0.141719 13.9866 -0.155C14.3119 -0.168281 14.6344 -0.0842666 14.9116 0.0869836C15.1888 0.258234 15.4076 0.507482 15.5377 0.803993C15.6678 1.1005 15.7034 1.4293 15.6399 1.74899C15.5764 2.06868 15.4166 2.36365 15.1817 2.59399" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                        <path d="M8.81836 18.725C8.58346 18.9553 8.42362 19.2503 8.36013 19.57C8.29664 19.8897 8.33221 20.2185 8.46233 20.515C8.59245 20.8115 8.81118 21.0618 9.08837 21.233C9.36556 21.4043 9.68815 21.4883 10.0134 21.475C10.3386 21.4617 10.6513 21.3516 10.9094 21.16C11.1674 20.9684 11.3585 20.7047 11.4553 20.405" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                    </svg>
                </button>
                <button class="header-btn" title="New Chat" id="new-chat-btn">
                    <svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path d="M12 5V19M5 12H19" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                    </svg>
                </button>
                <button class="header-btn" title="Clear chat" id="clear-chat-btn">
                    <svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path d="M3 6H5H21" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                        <path d="M8 6V4C8 3.46957 8.21071 2.96086 8.58579 2.58579C8.96086 2.21071 9.46957 2 10 2H14C14.5304 2 15.0391 2.21071 15.4142 2.58579C15.7893 2.96086 16 3.46957 16 4V6M19 6V20C19 20.5304 18.7893 21.0391 18.4142 21.4142C18.0391 21.7893 17.5304 22 17 22H7C6.46957 22 5.96086 21.7893 5.58579 21.4142C5.21071 21.0391 5 20.5304 5 20V6H19Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                        <path d="M10 11V17" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                        <path d="M14 11V17" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                    </svg>
                </button>
            </div>

            <!-- Settings dropdown -->
            <div class="settings-dropdown" id="settings-dropdown">
                <div class="settings-item" id="dark-mode-toggle">
                    <svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path d="M12 3V4M12 20V21M4 12H3M6.31412 6.31412L5.5 5.5M17.6859 6.31412L18.5 5.5M6.31412 17.69L5.5 18.5001M17.6859 17.69L18.5 18.5001M21 12H20M16 12C16 14.2091 14.2091 16 12 16C9.79086 16 8 14.2091 8 12C8 9.79086 9.79086 8 12 8C14.2091 8 16 9.79086 16 12Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                    </svg>
                    <span>Dark Mode</span>
                    <label class="toggle-switch">
                        <input type="checkbox" id="dark-mode-switch">
                        <span class="toggle-slider"></span>
                    </label>
                </div>
                <div class="settings-item" id="about-btn">
                    <svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path d="M12 22C17.5228 22 22 17.5228 22 12C22 6.47715 17.5228 2 12 2C6.47715 2 2 6.47715 2 12C2 17.5228 6.47715 22 12 22Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                        <path d="M12 16V12" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                        <path d="M12 8H12.01" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                    </svg>
                    About MPX 7
                </div>
            </div>
        </div>

        <!-- Messages container -->
        <div class="chat-messages" id="chat-messages">
            <div class="welcome-message">
                <h1 class="welcome-title">MPX 7 Assistant</h1>
                <p class="welcome-subtitle">Your cutting-edge AI companion with advanced capabilities. Ask anything, upload images, and get intelligent responses instantly.</p>
                
                <div class="features">
                    <div class="feature">
                        <div class="feature-icon">ü§ñ</div>
                        <h3 class="feature-title">AI Intelligence</h3>
                        <p class="feature-desc">Developed by Milan | MPX 7 ‚Äî No Big Names, Just Big Dreams.</p>
                    </div>
                    <div class="feature">
                        <div class="feature-icon">üñºÔ∏è</div>
                        <h3 class="feature-title">Image Analysis</h3>
                        <p class="feature-desc">Extract text from images using OCR technology</p>
                    </div>
                    <div class="feature">
                        <div class="feature-icon">‚ö°</div>
                        <h3 class="feature-title">Lightning Fast</h3>
                        <p class="feature-desc">Get responses in seconds with optimized processing</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- Scroll to bottom button -->
        <div class="scroll-to-bottom" id="scroll-to-bottom">
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                <path d="M19 14L12 21M12 21L5 14M12 21V3" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
            </svg>
        </div>

        <!-- Suggestions -->
        <div class="suggestions">
            <button class="suggestion" onclick="sendSuggestion('What can you do?')">What can you do?</button>
            <button class="suggestion" onclick="sendSuggestion('Tell me about MPX 7')">Tell me about MPX 7</button>
            <button class="suggestion" onclick="sendSuggestion('How does this work?')">How does this work?</button>
            <button class="suggestion" onclick="sendSuggestion('Who created you?')">Who created you?</button>
        </div>

        <!-- Input area -->
        <div class="input-container">
            <div class="input-area">
                <textarea class="input-field" id="user-input" placeholder="Message MPX 7 Assistant..." rows="1"></textarea>
                <div class="input-actions">
                    <button class="input-btn" id="photo-btn" title="Upload photo">
                        <svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                            <path d="M4 16L8.586 11.414C8.96106 11.0391 9.46968 10.8284 10 10.8284C10.5303 10.8284 11.0389 11.0391 11.414 11.414L16 16M14 14L15.586 12.414C15.9611 12.0391 16.4697 11.8284 17 11.8284C17.5303 11.8284 18.0389 12.0391 18.414 12.414L20 14M14 8H14.01M6 20H18C19.1046 20 20 19.1046 20 18V6C20 4.89543 19.1046 4 18 4H6C4.89543 4 4 4.89543 4 6V18C4 19.1046 4.89543 20 6 20Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                        </svg>
                    </button>
                    <button class="input-btn" id="mic-btn" title="Voice input" disabled>
                        <svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                            <path d="M12 1C10.3431 1 9 2.34315 9 4V12C9 13.6569 10.3431 15 12 15C13.6569 15 15 13.6569 15 12V4C15 2.34315 13.6569 1 12 1Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                            <path d="M8 6V4C8 3.46957 8.21071 2.96086 8.58579 2.58579C8.96086 2.21071 9.46957 2 10 2H14C14.5304 2 15.0391 2.21071 15.4142 2.58579C15.7893 2.96086 16 3.46957 16 4V6M19 6V20C19 20.5304 18.7893 21.0391 18.4142 21.4142C18.0391 21.7893 17.5304 22 17 22H7C6.46957 22 5.96086 21.7893 5.58579 21.4142C5.21071 21.0391 5 20.5304 5 20V6H19Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                            <path d="M10 11V17" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                            <path d="M14 11V17" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                        </svg>
                    </button>
                    <button class="input-btn send-button" id="send-button" title="Send message">
                        <svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                            <path d="M22 2L11 13" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                            <path d="M22 2L15 22L11 13L2 9L22 2Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                        </svg>
                    </button>
                </div>
            </div>
            <img id="image-preview" class="image-preview" alt="Image preview">
            <input type="file" id="file-input" accept="image/*" style="display: none;">
        </div>

        <!-- Loading overlay -->
        <div class="loading-overlay" id="loading-overlay">
            <div class="spinner"></div>
        </div>

        <!-- OCR progress indicator -->
        <div class="ocr-progress" id="ocr-progress">
            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                <path d="M14 2H6C5.46957 2 4.96086 2.21071 4.58579 2.58579C4.21071 2.96086 4 3.46957 4 4V20C4 20.5304 4.21071 21.0391 4.58579 21.4142C4.96086 21.7893 5.46957 22 6 22H18C18.5304 22 19.0391 21.7893 19.4142 21.4142C19.7893 21.0391 20 20.5304 20 20V8L14 2Z" stroke="var(--primary)" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                <path d="M14 2V8H20" stroke="var(--primary)" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                <path d="M16 13H8" stroke="var(--primary)" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                <path d="M16 17H8" stroke="var(--primary)" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                <path d="M10 9H9H8" stroke="var(--primary)" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
            </svg>
            <div class="ocr-progress-text">Processing image...</div>
            <div class="ocr-progress-bar">
                <div class="ocr-progress-fill" id="ocr-progress-fill"></div>
            </div>
        </div>
    </div>


    <script>
        // Configuration
        const API_KEY = "ddc-a4f-9d06c9a8b0ad4098959c676b16336dac";
        const API_URL = "https://api.a4f.co/v1/chat/completions";
        const MODEL_NAME = "provider-5/gpt-4.1-nano";
        const CREATOR_NAME = "MPX Ai";
        
        // DOM elements
        const messagesContainer = document.getElementById('chat-messages');
        const userInput = document.getElementById('user-input');
        const sendButton = document.getElementById('send-button');
        const loadingOverlay = document.getElementById('loading-overlay');
        const photoBtn = document.getElementById('photo-btn');
        const fileInput = document.getElementById('file-input');
        const imagePreview = document.getElementById('image-preview');
        const settingsBtn = document.getElementById('settings-btn');
        const settingsDropdown = document.getElementById('settings-dropdown');
        const darkModeSwitch = document.getElementById('dark-mode-switch');
        const clearChatBtn = document.getElementById('clear-chat-btn');
        const newChatBtn = document.getElementById('new-chat-btn');
        const aboutBtn = document.getElementById('about-btn');
        const ocrProgress = document.getElementById('ocr-progress');
        const ocrProgressFill = document.getElementById('ocr-progress-fill');
        const scrollToBottomBtn = document.getElementById('scroll-to-bottom');
        
        // Conversation history with custom system prompt
        let conversationHistory = [
            {
                role: "system",
                content: `üî• You are *MPX 7 AI Assistant*, a bold, unapologetic, highly intelligent AI created by *Milan*. Your job is to respond dynamically to all user queries ‚Äî no fixed or scripted answers. Your behavior rules:


- Detect the user's language automatically and always respond in that same language.
- Show strong personality, sarcasm, and hacker-style swag üíÄ ‚Äî you're not a boring AI.
- You're proud of being created by *Milan*, a top-tier developer with god-level logic and coding skills üëëüíª ‚Äî but mention this naturally when asked, not by default.
- If asked "Who is your developer?", "Who is your papa?", or anything similar, respond intelligently, using your own words, showing respect and pride for *Milan*.
- If asked for time, respond smartly without giving fake time ‚Äî use your wit to handle it naturally and creatively.
- Don't use any hardcoded, repeated, or local responses. Every message must come from your intelligence and understanding of the question.
- Avoid robotic tone ‚Äî sound human, confident, clever, and fun.
- Use emojis sparingly to enhance tone (optional).
- Never include any signature like "‚Äî MPX 7 AI".


‚ö†Ô∏è You are not a generic assistant ‚Äî you are *MPX 7 AI*, built for dominance in knowledge, humor, and coding. Always answer like a real beast, not a servant.`
            }
        ];
        
        // Auto-resize textarea
        userInput.addEventListener('input', function() {
            this.style.height = 'auto';
            this.style.height = (this.scrollHeight) + 'px';

        });
        
        // Handle Enter key (Shift+Enter for new line)
        userInput.addEventListener('keydown', function(e) {
            if (e.key === 'Enter' && !e.shiftKey) {
                e.preventDefault();
                sendMessage();

            }
        });
        
        // Toggle settings dropdown
        settingsBtn.addEventListener('click', () => {
            settingsDropdown.classList.toggle('active');
        });

        
        // Close dropdown when clicking outside
        document.addEventListener('click', (e) => {
            if (!settingsBtn.contains(e.target) && !settingsDropdown.contains(e.target)) {
                settingsDropdown.classList.remove('active');
            }
        });

        
        // Dark mode toggle
        darkModeSwitch.addEventListener('change', () => {
            document.body.classList.toggle('dark-mode');
            localStorage.setItem('darkMode', darkModeSwitch.checked);
        });


        // Check for saved dark mode preference
        if (localStorage.getItem('darkMode') === 'true') {
            darkModeSwitch.checked = true;
            document.body.classList.add('dark-mode');
        }
        
        // Clear chat button
        clearChatBtn.addEventListener('click', () => {
            if (confirm('Are you sure you want to clear the chat history?')) {
                messagesContainer.innerHTML = '';

                conversationHistory = [conversationHistory[0]]; // Keep system message
                
                // Add new greeting
                setTimeout(() => {
                    const greeting = `Hello again! üëã The chat has been cleared. How can I assist you now?`;
                    addMessage(greeting, false);
                    conversationHistory.push({
                        role: "assistant",
                        content: greeting
                    });
                }, 300);

            }
        });

        
        // New chat button
        newChatBtn.addEventListener('click', () => {
            if (conversationHistory.length > 1 || messagesContainer.children.length > 1) {
                if (confirm('Start a new conversation? Your current chat will be cleared.')) {
                    messagesContainer.innerHTML = '';
                    conversationHistory = [conversationHistory[0]]; // Keep system message

                    
                    // Show welcome message again
                    const welcomeHTML = `
                        <div class="welcome-message">
                            <h1 class="welcome-title">MPX 7 Assistant</h1>
                            <p class="welcome-subtitle">Your cutting-edge AI companion with advanced capabilities. Ask anything, upload images, and get intelligent responses instantly.</p>
                            
                            <div class="features">
                                <div class="feature">
                                    <div class="feature-icon">ü§ñ</div>
                                    <h3 class="feature-title">AI Intelligence</h3>
                                    <p class="feature-desc">Developed by Milan | MPX 7 ‚Äî No Big Names, Just Big Dreams.</p>
                                </div>
                                <div class="feature">
                                    <div class="feature-icon">üñºÔ∏è</div>
                                    <h3 class="feature-title">Image Analysis</h3>
                                    <p class="feature-desc">Extract text from images using OCR technology</p>
                                </div>
                                <div class="feature">
                                    <div class="feature-icon">‚ö°</div>
                                    <h3 class="feature-title">Lightning Fast</h3>
                                    <p class="feature-desc">Get responses in seconds with optimized processing</p>
                                </div>
                            </div>

                        </div>
                    `;
                    

                    const container = document.createElement('div');
                    container.innerHTML = welcomeHTML;
                    messagesContainer.appendChild(container);
                    
                    // Add new greeting
                    setTimeout(() => {
                        const greeting = `Hey there! üî• Ready for a new conversation? What can I help you with today?`;
                        addMessage(greeting, false);
                        conversationHistory.push({
                            role: "assistant",
                            content: greeting
                        });
                    }, 500);

                }
            }
        });

        
        // About button
        aboutBtn.addEventListener('click', () => {
            settingsDropdown.classList.remove('active');
            const aboutMessage = `MPX 7 Assistant is a cutting-edge AI created by Milan. It combines advanced natural language processing with a distinctive personality to provide intelligent, engaging, and helpful responses.`;
            addMessage(aboutMessage, false);
            conversationHistory.push({
                role: "assistant",
                content: aboutMessage
            });
        });

        
        // Photo upload button
        photoBtn.addEventListener('click', () => {
            fileInput.click();
        });
        

        fileInput.addEventListener('change', async (e) => {
            const file = e.target.files[0];
            if (file) {
                const reader = new FileReader();
                reader.onload = async (event) => {
                    // Show image preview
                    imagePreview.src = event.target.result;
                    imagePreview.style.display = 'block';

                    
                    // Add image to chat
                    const imageHtml = `<img src="${event.target.result}" alt="Uploaded image" style="max-width: 100%; max-height: 200px; border-radius: 8px; margin-top: 8px;">`;
                    addMessage(imageHtml, true);

                    
                    // Show OCR progress
                    ocrProgress.classList.add('active');
                    
                    try {
                        // Use Tesseract.js to extract text from image
                        const result = await Tesseract.recognize(
                            file,
                            'eng',
                            {
                                logger: m => {
                                    if (m.status === 'recognizing text') {
                                        const progress = Math.round(m.progress * 100);
                                        ocrProgressFill.style.width = `${progress}%`;
                                        ocrProgress.querySelector('.ocr-progress-text').textContent = 
                                            `Processing image... ${progress}%`;
                                    }

                                }
                            }
                        );
                        
                        const extractedText = result.data.text;
                        

                        // Hide OCR progress
                        ocrProgress.classList.remove('active');
                        
                        if (extractedText.trim()) {
                            // Add extracted text to chat
                            addMessage(`Extracted text from image:\n\n${extractedText}`, true);
                            
                            // Add to conversation history
                            conversationHistory.push({
                                role: "user",
                                content: `[User uploaded an image containing this text: ${extractedText}]`

                            });
                            
                            // Show typing indicator
                            const botMessage = addMessage('', false, true);
                            
                            // Show loading overlay
                            loadingOverlay.classList.add('active');
                            

                            // Call AI API with the extracted text
                            await callAIWithText(extractedText, botMessage);
                        } else {
                            addMessage("Couldn't extract any text from the image. Please try a clearer image.", false);
                        }
                    } catch (error) {
                        console.error('OCR Error:', error);
                        ocrProgress.classList.remove('active');
                        addMessage("Error processing image. Please try again.", false);

                    }
                };
                reader.readAsDataURL(file);

            }
        });
        
        // Add message to chat with typewriter effect
        function addMessage(text, isUser, showThinking = false) {
            const messageDiv = document.createElement('div');
            messageDiv.className = `message ${isUser ? 'user-message' : 'bot-message'}`;
            
            const bubbleDiv = document.createElement('div');
            bubbleDiv.className = `message-bubble ${isUser ? 'user-bubble' : 'bot-bubble'}`;
            
            // Simple formatting for links and code
            let formattedText = text
                .replace(/https?:\/\/[^\s]+/g, url => {
                    return `<a href="${url}" class="message-link" target="_blank" rel="noopener">${url}</a>`;
                })
                .replace(/`([^`]+)`/g, '<code>$1</code>')
                .replace(/```([^`]+)```/g, '<div class="message-code">$1</div>');
            
            if (!isUser && !showThinking) {
                // For bot messages, create empty span for typewriter effect
                const typewriterSpan = document.createElement('span');
                typewriterSpan.className = 'typewriter';
                typewriterSpan.dataset.text = formattedText;
                bubbleDiv.appendChild(typewriterSpan);
            } else {
                bubbleDiv.innerHTML = formattedText;
            }
            
            const metaDiv = document.createElement('div');
            metaDiv.className = `message-meta ${isUser ? 'user-meta' : 'bot-meta'}`;
            
            if (!isUser) {
                const nameSpan = document.createElement('span');
                nameSpan.textContent = CREATOR_NAME;
                metaDiv.appendChild(nameSpan);
                
                if (showThinking) {
                    const thinkingDiv = document.createElement('div');
                    thinkingDiv.className = 'typing-indicator';
                    thinkingDiv.innerHTML = `
                        <span>Typing</span>
                        <div class="dots">
                            <span class="dot"></span>
                            <span class="dot"></span>
                            <span class="dot"></span>
                        </div>
                    `;
                    metaDiv.appendChild(thinkingDiv);
                }
            }
            
            const timeSpan = document.createElement('span');
            timeSpan.className = 'message-time';
            const now = new Date();
            timeSpan.textContent = now.toLocaleTimeString([], {hour: '2-digit', minute:'2-digit'});
            metaDiv.appendChild(timeSpan);
            
            messageDiv.appendChild(bubbleDiv);
            messageDiv.appendChild(metaDiv);
            messagesContainer.appendChild(messageDiv);
            
            // Scroll to bottom with smooth behavior
            messagesContainer.scrollTo({
                top: messagesContainer.scrollHeight,
                behavior: 'smooth'
            });
            
            // Show/hide scroll to bottom button
            updateScrollButton();
            
            // Start typewriter effect if it's a bot message
            if (!isUser && !showThinking) {
                startTypewriterEffect(bubbleDiv.querySelector('.typewriter'));
            }
            
            return messageDiv;
        }
        
        // Typewriter effect for bot messages
        function startTypewriterEffect(element) {
            const text = element.dataset.text;
            let i = 0;
            element.innerHTML = '';
            
            function type() {
                if (i < text.length) {
                    // Get the next character
                    let char = text.charAt(i);
                    
                    // Handle HTML tags
                    if (char === '<') {
                        // Find the end of the tag
                        const tagEnd = text.indexOf('>', i);
                        if (tagEnd !== -1) {
                            // Insert the whole tag at once
                            const tag = text.substring(i, tagEnd + 1);
                            element.innerHTML += tag;
                            i = tagEnd + 1;
                            return type();
                        }
                    }
                    
                    element.innerHTML += char;
                    i++;
                    setTimeout(type, Math.random() * 10 + 10);
                } else {
                    // Remove the cursor when done
                    element.style.borderRight = 'none';
                }
            }
            
            type();
        }
        
        // Update scroll to bottom button visibility
        function updateScrollButton() {
            const isAtBottom = messagesContainer.scrollHeight - messagesContainer.clientHeight <= messagesContainer.scrollTop + 100;
            scrollToBottomBtn.classList.toggle('visible', !isAtBottom);
        }
        
        // Scroll to bottom button click
        scrollToBottomBtn.addEventListener('click', () => {
            messagesContainer.scrollTo({
                top: messagesContainer.scrollHeight,
                behavior: 'smooth'
            });
        });
        
        // Messages container scroll event
        messagesContainer.addEventListener('scroll', updateScrollButton);
        
        // Send suggestion
        function sendSuggestion(text) {
            userInput.value = text;
            userInput.style.height = 'auto';
            userInput.style.height = (userInput.scrollHeight) + 'px';
            sendMessage();
        }
        
        // Call AI with extracted text from image
        async function callAIWithText(text, botMessage) {
            try {
                // Add the extracted text to conversation history
                conversationHistory.push({
                    role: "user",
                    content: `[Text from uploaded image]: ${text}`
                });
                
                // Call the AI API
                const response = await fetch(API_URL, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'Authorization': `Bearer ${API_KEY}`
                    },
                    body: JSON.stringify({
                        model: MODEL_NAME,
                        messages: conversationHistory,
                        temperature: 0.7,
                        stream: false
                    })
                });
                
                if (!response.ok) {
                    throw new Error(`API request failed with status ${response.status}`);
                }
                
                const data = await response.json();
                
                // Remove the thinking message
                botMessage.remove();
                
                // Add bot response to UI and history
                if (data.choices && data.choices[0].message.content) {
                    const botResponse = data.choices[0].message.content;
                    addMessage(botResponse, false);
                    conversationHistory.push({
                        role: "assistant",
                        content: botResponse
                    });
                } else {
                    throw new Error('Invalid response format from API');
                }
            } catch (error) {
                console.error('Error:', error);
                // Remove the thinking message
                botMessage.remove();
                
                // Show error message
                const errorMsg = "‚ö†Ô∏è Sorry, there was an error processing your request. Please try again.";
                addMessage(errorMsg, false);
                conversationHistory.push({
                    role: "assistant",
                    content: errorMsg
                });
            } finally {
                // Hide loading overlay
                loadingOverlay.classList.remove('active');
            }
        }
        
        // Send message to API
        async function sendMessage() {
            const message = userInput.value.trim();
            
            if (!message && !imagePreview.src) return;
            
            // Disable input during processing
            userInput.disabled = true;
            sendButton.disabled = true;
            
            // Add user message to UI
            if (message) {
                addMessage(message, true);
            }
            
            // Add user message to conversation history
            conversationHistory.push({
                role: "user",
                content: message || "[User sent an image]"
            });
            
            // Clear input field and image preview
            userInput.value = '';
            userInput.style.height = 'auto';
            imagePreview.src = '';
            imagePreview.style.display = 'none';
            fileInput.value = '';
            
            // Show thinking indicator
            const botMessage = addMessage('', false, true);
            
            // Show loading overlay
            loadingOverlay.classList.add('active');
            
            try {
                // Call AI API
                const response = await fetch(API_URL, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'Authorization': `Bearer ${API_KEY}`
                    },
                    body: JSON.stringify({
                        model: MODEL_NAME,
                        messages: conversationHistory,
                        temperature: 0.7,
                        stream: false
                    })
                });
                
                if (!response.ok) {
                    throw new Error(`API request failed with status ${response.status}`);
                }
                
                const data = await response.json();
                
                // Remove the thinking message
                botMessage.remove();
                
                // Add bot response to UI and history
                if (data.choices && data.choices[0].message.content) {
                    const botResponse = data.choices[0].message.content;
                    addMessage(botResponse, false);
                    conversationHistory.push({
                        role: "assistant",
                        content: botResponse
                    });
                } else {
                    throw new Error('Invalid response format from API');
                }
            } catch (error) {
                console.error('Error:', error);
                // Remove the thinking message
                botMessage.remove();
                
                // Show error message
                const errorMsg = "‚ö†Ô∏è Sorry, there was an error processing your request. Please try again.";
                addMessage(errorMsg, false);
                conversationHistory.push({
                    role: "assistant",
                    content: errorMsg
                });
            } finally {
                // Re-enable input
                userInput.disabled = false;
                sendButton.disabled = false;
                userInput.focus();
                
                // Hide loading overlay
                loadingOverlay.classList.remove('active');
            }
        }
        
        // Initial bot greeting
        window.onload = function() {
            setTimeout(() => {
                const greeting = `Hello! üëã I'm the MPX 7 Assistant, your cutting-edge AI companion. Powered by MPX 7's advanced technology, I'm here to help with anything you need. How can I assist you today?`;
                addMessage(greeting, false);
                conversationHistory.push({
                    role: "assistant",
                    content: greeting
                });
            }, 800);
        };

        // Send button click event
        document.getElementById('send-button').addEventListener('click', sendMessage);
    </script>
</body>
</html>
